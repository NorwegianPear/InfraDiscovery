<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 900">
  <defs>
    <!-- Gradients -->
    <linearGradient id="adminGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#d4af37;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#b8860b;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="operatorGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0078D4;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#005a9e;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="viewerGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#107C10;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#0b5c0b;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="tenantGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#5c2d91;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#3b1d60;stop-opacity:1" />
    </linearGradient>
    
    <!-- Shadow filter -->
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="3" dy="3" stdDeviation="4" flood-opacity="0.2"/>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="1200" height="900" fill="#f8f9fa"/>
  
  <!-- Title -->
  <text x="600" y="45" text-anchor="middle" font-family="Segoe UI, Arial" font-size="28" font-weight="600" fill="#1a1a1a">
    Role-Based Access Control (RBAC) Architecture
  </text>
  <text x="600" y="75" text-anchor="middle" font-family="Segoe UI, Arial" font-size="14" fill="#666">
    Atea Identity &amp; License Management Portal - Access Control Model
  </text>

  <!-- Tenant Boundary Box -->
  <rect x="50" y="100" width="1100" height="780" rx="20" fill="none" stroke="#5c2d91" stroke-width="3" stroke-dasharray="10,5"/>
  <rect x="50" y="100" width="300" height="40" rx="10" fill="url(#tenantGrad)"/>
  <text x="200" y="127" text-anchor="middle" font-family="Segoe UI, Arial" font-size="14" font-weight="600" fill="white">
    ğŸ”’ Tenant Boundary: ateara.onmicrosoft.com
  </text>

  <!-- Authentication Flow -->
  <g transform="translate(100, 160)">
    <rect width="200" height="100" rx="12" fill="white" stroke="#0078D4" stroke-width="2" filter="url(#shadow)"/>
    <text x="100" y="35" text-anchor="middle" font-family="Segoe UI, Arial" font-size="14" font-weight="600" fill="#1a1a1a">ğŸŒ User Request</text>
    <text x="100" y="55" text-anchor="middle" font-family="Segoe UI, Arial" font-size="11" fill="#666">Browser Access</text>
    <text x="100" y="75" text-anchor="middle" font-family="Segoe UI, Arial" font-size="10" fill="#999">app-atea-idlm-dev.azurewebsites.net</text>
  </g>

  <!-- Arrow: User to MSAL -->
  <path d="M 300 210 L 380 210" stroke="#0078D4" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#0078D4"/>
    </marker>
  </defs>

  <!-- MSAL Authentication -->
  <g transform="translate(380, 160)">
    <rect width="200" height="100" rx="12" fill="white" stroke="#0078D4" stroke-width="2" filter="url(#shadow)"/>
    <text x="100" y="35" text-anchor="middle" font-family="Segoe UI, Arial" font-size="14" font-weight="600" fill="#1a1a1a">ğŸ” MSAL Auth</text>
    <text x="100" y="55" text-anchor="middle" font-family="Segoe UI, Arial" font-size="11" fill="#666">Microsoft Entra ID</text>
    <text x="100" y="75" text-anchor="middle" font-family="Segoe UI, Arial" font-size="10" fill="#999">Tenant: 973a580f-021f-...</text>
  </g>

  <!-- Arrow: MSAL to Tenant Check -->
  <path d="M 580 210 L 660 210" stroke="#0078D4" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>

  <!-- Tenant Validation -->
  <g transform="translate(660, 160)">
    <rect width="200" height="100" rx="12" fill="white" stroke="#5c2d91" stroke-width="2" filter="url(#shadow)"/>
    <text x="100" y="35" text-anchor="middle" font-family="Segoe UI, Arial" font-size="14" font-weight="600" fill="#1a1a1a">ğŸ›¡ï¸ Tenant Check</text>
    <text x="100" y="55" text-anchor="middle" font-family="Segoe UI, Arial" font-size="11" fill="#666">Validate Tenant ID</text>
    <text x="100" y="75" text-anchor="middle" font-family="Segoe UI, Arial" font-size="10" fill="#d13438">âŒ Block if not matching</text>
  </g>

  <!-- Arrow: Tenant Check to RBAC -->
  <path d="M 860 210 L 940 210" stroke="#107C10" stroke-width="2" fill="none" marker-end="url(#arrowhead2)"/>
  <defs>
    <marker id="arrowhead2" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#107C10"/>
    </marker>
  </defs>
  <text x="900" y="200" text-anchor="middle" font-family="Segoe UI, Arial" font-size="10" fill="#107C10">âœ“ Valid</text>

  <!-- RBAC Module -->
  <g transform="translate(940, 160)">
    <rect width="180" height="100" rx="12" fill="white" stroke="#107C10" stroke-width="2" filter="url(#shadow)"/>
    <text x="90" y="35" text-anchor="middle" font-family="Segoe UI, Arial" font-size="14" font-weight="600" fill="#1a1a1a">âš™ï¸ RBAC Module</text>
    <text x="90" y="55" text-anchor="middle" font-family="Segoe UI, Arial" font-size="11" fill="#666">Assign Role</text>
    <text x="90" y="75" text-anchor="middle" font-family="Segoe UI, Arial" font-size="10" fill="#999">Check Permissions</text>
  </g>

  <!-- Arrow down from RBAC to Roles -->
  <path d="M 1030 260 L 1030 300" stroke="#666" stroke-width="2" fill="none" marker-end="url(#arrowhead3)"/>
  <defs>
    <marker id="arrowhead3" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
    </marker>
  </defs>

  <!-- Role Definitions Section -->
  <text x="600" y="330" text-anchor="middle" font-family="Segoe UI, Arial" font-size="20" font-weight="600" fill="#1a1a1a">
    Role Definitions
  </text>

  <!-- Admin Role Box -->
  <g transform="translate(100, 360)">
    <rect width="320" height="240" rx="15" fill="url(#adminGrad)" filter="url(#shadow)"/>
    <text x="160" y="35" text-anchor="middle" font-family="Segoe UI, Arial" font-size="18" font-weight="600" fill="white">ğŸ‘‘ Administrator</text>
    <text x="160" y="55" text-anchor="middle" font-family="Segoe UI, Arial" font-size="12" fill="rgba(255,255,255,0.9)">Level 3 - Full Access</text>
    
    <!-- Admin Users -->
    <rect x="15" y="70" width="290" height="80" rx="8" fill="rgba(255,255,255,0.15)"/>
    <text x="25" y="90" font-family="Segoe UI, Arial" font-size="11" font-weight="600" fill="white">Authorized Users:</text>
    <text x="25" y="108" font-family="Consolas, monospace" font-size="10" fill="rgba(255,255,255,0.9)">â€¢ uylephan@ateara.onmicrosoft.com</text>
    <text x="25" y="123" font-family="Consolas, monospace" font-size="10" fill="rgba(255,255,255,0.9)">â€¢ anders.dramstad@ateara.onmicrosoft.com</text>
    
    <!-- Admin Permissions -->
    <text x="25" y="168" font-family="Segoe UI, Arial" font-size="11" font-weight="600" fill="white">Permissions:</text>
    <text x="25" y="186" font-family="Segoe UI, Arial" font-size="10" fill="rgba(255,255,255,0.9)">âœ“ All Operator permissions</text>
    <text x="25" y="201" font-family="Segoe UI, Arial" font-size="10" fill="rgba(255,255,255,0.9)">âœ“ manage:roles, manage:users</text>
    <text x="25" y="216" font-family="Segoe UI, Arial" font-size="10" fill="rgba(255,255,255,0.9)">âœ“ view:auditlog, configure:portal</text>
  </g>

  <!-- Operator Role Box -->
  <g transform="translate(440, 360)">
    <rect width="320" height="240" rx="15" fill="url(#operatorGrad)" filter="url(#shadow)"/>
    <text x="160" y="35" text-anchor="middle" font-family="Segoe UI, Arial" font-size="18" font-weight="600" fill="white">ğŸ”§ Operator</text>
    <text x="160" y="55" text-anchor="middle" font-family="Segoe UI, Arial" font-size="12" fill="rgba(255,255,255,0.9)">Level 2 - Operational Access</text>
    
    <!-- Operator Users -->
    <rect x="15" y="70" width="290" height="80" rx="8" fill="rgba(255,255,255,0.15)"/>
    <text x="25" y="90" font-family="Segoe UI, Arial" font-size="11" font-weight="600" fill="white">Authorized Users:</text>
    <text x="25" y="108" font-family="Consolas, monospace" font-size="10" fill="rgba(255,255,255,0.9)">â€¢ lene.kadaa@ateara.onmicrosoft.com</text>
    <text x="25" y="123" font-family="Consolas, monospace" font-size="10" fill="rgba(255,255,255,0.9)">â€¢ veronica@ateara.onmicrosoft.com</text>
    
    <!-- Operator Permissions -->
    <text x="25" y="168" font-family="Segoe UI, Arial" font-size="11" font-weight="600" fill="white">Permissions:</text>
    <text x="25" y="186" font-family="Segoe UI, Arial" font-size="10" fill="rgba(255,255,255,0.9)">âœ“ All Viewer permissions</text>
    <text x="25" y="201" font-family="Segoe UI, Arial" font-size="10" fill="rgba(255,255,255,0.9)">âœ“ create/edit/delete:task</text>
    <text x="25" y="216" font-family="Segoe UI, Arial" font-size="10" fill="rgba(255,255,255,0.9)">âœ“ accept:recommendation, export:data</text>
  </g>

  <!-- Viewer Role Box -->
  <g transform="translate(780, 360)">
    <rect width="320" height="240" rx="15" fill="url(#viewerGrad)" filter="url(#shadow)"/>
    <text x="160" y="35" text-anchor="middle" font-family="Segoe UI, Arial" font-size="18" font-weight="600" fill="white">ğŸ‘ï¸ Viewer</text>
    <text x="160" y="55" text-anchor="middle" font-family="Segoe UI, Arial" font-size="12" fill="rgba(255,255,255,0.9)">Level 1 - Read-Only Access</text>
    
    <!-- Viewer Users -->
    <rect x="15" y="70" width="290" height="80" rx="8" fill="rgba(255,255,255,0.15)"/>
    <text x="25" y="90" font-family="Segoe UI, Arial" font-size="11" font-weight="600" fill="white">Authorized Users:</text>
    <text x="25" y="108" font-family="Consolas, monospace" font-size="10" fill="rgba(255,255,255,0.9)">â€¢ All other tenant users</text>
    <text x="25" y="123" font-family="Consolas, monospace" font-size="10" fill="rgba(255,255,255,0.9)">â€¢ (Default role for authenticated users)</text>
    
    <!-- Viewer Permissions -->
    <text x="25" y="168" font-family="Segoe UI, Arial" font-size="11" font-weight="600" fill="white">Permissions:</text>
    <text x="25" y="186" font-family="Segoe UI, Arial" font-size="10" fill="rgba(255,255,255,0.9)">âœ“ view:dashboard, view:users</text>
    <text x="25" y="201" font-family="Segoe UI, Arial" font-size="10" fill="rgba(255,255,255,0.9)">âœ“ view:licenses, view:security</text>
    <text x="25" y="216" font-family="Segoe UI, Arial" font-size="10" fill="rgba(255,255,255,0.9)">âœ“ view:reports, view:documentation</text>
  </g>

  <!-- Permission Matrix Section -->
  <text x="600" y="650" text-anchor="middle" font-family="Segoe UI, Arial" font-size="20" font-weight="600" fill="#1a1a1a">
    Permission Matrix - Mitigation Page
  </text>

  <!-- Permission Matrix Table -->
  <g transform="translate(100, 670)">
    <!-- Header -->
    <rect width="1000" height="35" rx="8" fill="#2d2d2d"/>
    <text x="250" y="23" text-anchor="middle" font-family="Segoe UI, Arial" font-size="12" font-weight="600" fill="white">Action</text>
    <text x="500" y="23" text-anchor="middle" font-family="Segoe UI, Arial" font-size="12" font-weight="600" fill="white">ğŸ‘‘ Admin</text>
    <text x="666" y="23" text-anchor="middle" font-family="Segoe UI, Arial" font-size="12" font-weight="600" fill="white">ğŸ”§ Operator</text>
    <text x="833" y="23" text-anchor="middle" font-family="Segoe UI, Arial" font-size="12" font-weight="600" fill="white">ğŸ‘ï¸ Viewer</text>
    
    <!-- Rows -->
    <rect y="35" width="1000" height="30" fill="#f8f9fa"/>
    <text x="20" y="55" font-family="Segoe UI, Arial" font-size="11" fill="#333">View Dashboard/Reports</text>
    <text x="500" y="55" text-anchor="middle" font-family="Segoe UI, Arial" font-size="14" fill="#107C10">âœ“</text>
    <text x="666" y="55" text-anchor="middle" font-family="Segoe UI, Arial" font-size="14" fill="#107C10">âœ“</text>
    <text x="833" y="55" text-anchor="middle" font-family="Segoe UI, Arial" font-size="14" fill="#107C10">âœ“</text>
    
    <rect y="65" width="1000" height="30" fill="white"/>
    <text x="20" y="85" font-family="Segoe UI, Arial" font-size="11" fill="#333">Create/Edit/Delete Mitigation Tasks</text>
    <text x="500" y="85" text-anchor="middle" font-family="Segoe UI, Arial" font-size="14" fill="#107C10">âœ“</text>
    <text x="666" y="85" text-anchor="middle" font-family="Segoe UI, Arial" font-size="14" fill="#107C10">âœ“</text>
    <text x="833" y="85" text-anchor="middle" font-family="Segoe UI, Arial" font-size="14" fill="#d13438">âœ—</text>
    
    <rect y="95" width="1000" height="30" fill="#f8f9fa"/>
    <text x="20" y="115" font-family="Segoe UI, Arial" font-size="11" fill="#333">Accept AI Recommendations</text>
    <text x="500" y="115" text-anchor="middle" font-family="Segoe UI, Arial" font-size="14" fill="#107C10">âœ“</text>
    <text x="666" y="115" text-anchor="middle" font-family="Segoe UI, Arial" font-size="14" fill="#107C10">âœ“</text>
    <text x="833" y="115" text-anchor="middle" font-family="Segoe UI, Arial" font-size="14" fill="#d13438">âœ—</text>
    
    <rect y="125" width="1000" height="30" fill="white"/>
    <text x="20" y="145" font-family="Segoe UI, Arial" font-size="11" fill="#333">Manage User Roles &amp; Audit Logs</text>
    <text x="500" y="145" text-anchor="middle" font-family="Segoe UI, Arial" font-size="14" fill="#107C10">âœ“</text>
    <text x="666" y="145" text-anchor="middle" font-family="Segoe UI, Arial" font-size="14" fill="#d13438">âœ—</text>
    <text x="833" y="145" text-anchor="middle" font-family="Segoe UI, Arial" font-size="14" fill="#d13438">âœ—</text>
    
    <!-- Border -->
    <rect y="35" width="1000" height="120" fill="none" stroke="#ddd" stroke-width="1"/>
  </g>

  <!-- Legend -->
  <g transform="translate(100, 830)">
    <rect width="200" height="40" rx="6" fill="#e8f5e9" stroke="#107C10"/>
    <text x="15" y="25" font-family="Segoe UI, Arial" font-size="12" fill="#107C10">âœ“ = Allowed</text>
    <rect x="220" width="200" height="40" rx="6" fill="#ffebee" stroke="#d13438"/>
    <text x="235" y="25" font-family="Segoe UI, Arial" font-size="12" fill="#d13438">âœ— = Denied</text>
    <rect x="440" width="300" height="40" rx="6" fill="#f3e5f5" stroke="#5c2d91"/>
    <text x="455" y="25" font-family="Segoe UI, Arial" font-size="12" fill="#5c2d91">ğŸ”’ External tenants blocked at login</text>
  </g>

</svg>
